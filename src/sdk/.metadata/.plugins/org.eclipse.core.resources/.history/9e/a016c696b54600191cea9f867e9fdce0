#include "peripheral.h"
#include "xgpio.h"
#include <stdio.h>
#include <math.h>

#define REQ_FREQ 300
#define FREQ 100000
#define AMPLITUDE 255

XGpio gpio;
double angle;

void timerCallback()
{
//	xil_printf("timer tick!");
	unsigned char sample = (AMPLITUDE * sin(angle))+(AMPLITUDE/2);
	xil_printf("%d\r\n", sample);
	XGpio_DiscreteWrite(&gpio, 1, sample);
	angle += (2 * M_PI * REQ_FREQ) / FREQ;
}

int main(void)
{
	timerSetup(&timerCallback);

	XGpio_Initialize(&gpio, 1);
	XGpio_SetDataDirection(&gpio, 1, 0x00000000);

	angle = 0.0;

	for(;;);
}
